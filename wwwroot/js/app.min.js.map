{"version":3,"sources":["wwwroot/js/app.js"],"names":["app","angular","module","config","$routeProvider","$locationProvider","when","controller","templateUrl","title","isForward","otherwise","html5Mode","$scope","$timeout","$http","$location","model","signin","signinFormError","signinFormBusy","clicked","post","then","success","console","log","path","error","message","label","setTimeout","item","id","user","userName","facebookId","route","dish","price","isVeganFriendly","yes","no","created","vote","dishId","like","categories","name","key","picture","guid","loadStream","get","response","items","data","animation","$rootScope","$animate","isFirstView","currentRoute","isBackward","previousRoute","bezierOptions","type","dynamics","bezier","points","x","y","cp","duration","$on","event","current","previous","$$route","enter","element","done","css","translateY","opacity","scale","animate","w","offsetWidth","translateX","leave","LESSON","CONFIG","CLIENT","window","location","href","indexOf","API","FACEBOOK_APP_ID","assetTypeEnum","Unknown","Picture","IOS","navigator","userAgent","match","constant","controllerAs","resolve","Users","isLoggedOrGoTo","$httpProvider","defaults","withCredentials","directive","restrict","link","scope","attributes","onTap","e","addClass","removeClass","addListeners","on","removeListeners","off","delays","undefined","split","delay","forEach","d","i","parseInt","length","push","removeClasses","join","shift","a","$parse","$compile","$window","Utils","doTop","busy","onTop","$apply","sy","ey","undrag","doBottom","onBottom","lbottom2","offsetHeight","inner","lbottom","padding","dragging","wheeling","move","down","removeDragListeners","bounce","ltop","redraw","time","speed","Math","abs","cy","pause","min","max","innerStyle","transform","toFixed","set","showIndicatorFor","percent","iy","indicator","ix","round","rows","html","count","indicatorStyle","play","loop","aKey","requestAnimationFrame","cancelAnimationFrame","onDown","getTouch","addDragListeners","onMove","prev","onUp","up","_onWheel","dir","deltaY","wheelDelta","onWheel","ondragstart","$eval","attr","find","Style","append","contents","throttle","src","ngImg","image","Image","onload","$set","this","load","$watch","newValue","WebWorker","worker","doWork","onImageLoaded","url","ngImgWorker","replace","template","form","placeholder","formKey","formFocus","required","readonly","control","options","number","source","canCreate","flatten","queryable","onSelected","MAX_ITEMS","service","getPhrase","Clear","phrase","input","val","Current","active","onTyping","Enter","onSelect","Up","Down","Parse","value","index","toLowerCase","NameA","substr","NameB","NameC","Filter","c","Search","setPhrase","onKeyDown","keyCode","preventDefault","onKeyUp","call","getClosest","target","onBlur","Init","init","maxItems","Number","POSITIVE_INFINITY","onFocus","$parent","setItem","parsedItem","$item","$event","extend","$watchCollection","require","validateType","$parsers","unshift","$setValidity","String","toString","filter","$filter","legacyFilter","cost","currency","ratio","formatting","APP","inches","unit","units","IMPERIAL","feet","floor","meters","size","cm","pounds","oz","kg","weight","grams","precision","format","timezone","parseTime","parseHour","Guest","User","Supervisor","Admin","factory","UserRolesEnum","prototype","isAdmin","role","isUser","email","backgroundPicture","$q","FacebookService","onFacebookStatus","deferred","authResponse","status","reject","FB","defer","promise","getFacebookMe","facebook","api","fields","getPictureMe","width","height","getLoginStatus","login","logout","deletePermissions","fbAsyncInit","appId","cookie","xfbml","version","s","js","fjs","getElementsByTagName","getElementById","createElement","parentNode","insertBefore","document","LocalStorage","_currentUser","currentUser","getCurrentUser","isLogged","isAuthenticated","redirect","isAdminOrGoTo","signup","signInWithFacebook","auth","signout","detail","userRoute","Vector","make","b","sqrt","normalize","l","incidence","angle","atan2","distance","cross","difference","towards","friction","add","copy","t","touch","originalEvent","touches","changedTouches","pageX","pageY","getRelativeTouch","point","rect","getBoundingClientRect","left","top","el","selector","matchesFn","parent","some","fn","body","parentElement","func","wait","context","args","result","timeout","later","leading","getNow","apply","now","remaining","arguments","clearTimeout","trailing","lastTime","vendors","callback","currTime","Date","getTime","timeToCall","transformProperty","safariPropertyHack","div","style","every","prefix","props","hoverScale","currentScale","styles","cssText","transformOrigin","self","callbacks","Worker","onmessage","isWebWorkerSupported","transformResponse","h","eval","object","o","postMessage","parse","JSON","stringify","isSupported","$httpAsync","wrap","getDefaults","isSuccess","createMap","Object","create","isString","parseHeaders","headers","fillInParsed","parsed","j","line","lowercase","trim","isObject","p","headersGetter","headersObj","method","responseType","common","string","head","put","patch","getter","statusText"],"mappings":"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","file":"wwwroot/js/app.min.js","sourcesContent":["/*global angular,FB */\n\nvar app = angular.module('ullo', ['ngRoute', 'ngAnimate']);\n\napp.config(['$routeProvider', '$locationProvider', function ($routeProvider, $locationProvider) {\n\n\t$routeProvider.when('/', {                \n        controller: 'SignInCtrl',\n        templateUrl: 'templates/signin-test.html',\n        title: 'Sign In',\n        \n    }).when('/signin', {                \n        controller: 'SignInCtrl',\n        templateUrl: 'templates/signin-test.html',\n        title: 'Sign In',\n        \n    }).when('/stream', {        \n        controller: 'TestCtrl',\n        templateUrl: 'templates/test.html',\n        title: 'TestCtrl',\n        isForward: true\n        \n    }).when('/dishes/:dishId', {        \n        controller: 'TestCtrl',\n        templateUrl: 'templates/test.html',\n        title: 'Dishes',\n        \n    }).when('/test', {                \n        controller: 'TestCtrl',\n        templateUrl: 'templates/temp.html',\n        title: 'HomePage',\n        \n    }).when('/404', {\n        controller: 'TestCtrl',\n        templateUrl: 'templates/test.html',\n        title: 'Errore 404',\n        isForward: true\n        \n    });\n    \n    $routeProvider.otherwise('/404');\n    \n    // HTML5 MODE url writing method (false: #/anchor/use, true: /html5/url/use)\n    $locationProvider.html5Mode(true);\n    \n}]);\n\napp.controller('SignInCtrl', ['$scope', '$timeout', '$http', '$location', function ($scope, $timeout, $http, $location) {\n\n    $scope.model = {};\n\n    $scope.signin = function () {\n        $scope.signinFormError = null;\n        $scope.signinFormBusy = true;\n        $scope.clicked = true;\n        $timeout(function() {\n            $http.post('http://ulloapi.wslabs.it/api/users/signin', $scope.model).then(function(success) {\n                console.log('signin', success);\n                $location.path('/stream');\n            }, function(error) {\n                console.log('error', error);\n                $scope.signinFormError = { message: error.message };\n            }).finally(function() {\n                $timeout(function() {\n                    $scope.signinFormBusy = false;\n                }, 3000);\n            });\n            $scope.clicked = false;\n        }, 1000);\n    };\n    \n}]);\n    \napp.controller('TestCtrl', ['$scope', '$timeout', '$http', function ($scope, $timeout, $http) {\n\n    $scope.model = {\n        label: 'Carica',\n    };\n        \n    setTimeout(function() {\n        $scope.model.label = 'Carica Stream';\n    }, 1000);\n\n    $scope.item = {\n        id: 117,\n        user: {\n            userName: 'Fabio Ottaviani',\n            facebookId: '10153341954226947',\n            route: 'fabio-ottaviani'\n        },\n        dish: {\n            price: 5,\n            isVeganFriendly: false,\n            yes: 1,\n            no: 0,\n            created: '2016-04-27T19:13:45.497',\n            vote: {\n                dishId: 19,\n                like: true,\n                created: '2016-04-27T19:14:00.497'\n            },\n            categories: [\n                {\n                    id: 2,\n                    name: 'Piadine',\n                    key: 'piadine'\n                }\n            ],\n            id: 19,\n            name: 'Pizza Margherita',\n            key: 'pizzaMargherita'\n        },\n        picture: {\n            guid: '8fe99743-4ed3-46de-ba13-2c1bd7a45ffe',\n            created: '2016-04-27T19:13:41.02',\n            id: 20,\n            name: '8fe99743-4ed3-46de-ba13-2c1bd7a45ffe',\n            route: '/Media/Files/8fe99743-4ed3-46de-ba13-2c1bd7a45ffe.jpg',\n            key: '8Fe997434Ed346DeBa132C1bd7a45ffe'\n        },\n        created: '2016-04-27T19:13:45.497'\n    };\n    \n    $scope.loadStream = function() {\n        $http.get('http://ulloapi.wslabs.it/api/stream/anonymous').then(function(response){\n            $scope.items = response.data;\n        }, function(error) {\n            console.log('error', error);\n        });\n    };\n\n}]);\n\n\n/*global angular,dynamics*/\n\n\napp.animation('.navigation', ['$rootScope', '$animate', function($rootScope, $animate) {\n    var previousRoute = null;\n    var currentRoute = null;\n    var bezierOptions = {\n        type: dynamics.bezier,\n        points: [{ x: 0, y: 0, cp: [{ x: 0.509, y: 0.007 }] }, { x: 1, y: 1, cp: [{ x: 0.566, y: 0.997 }] }],\n        duration: 500,\n    }\n    $rootScope.$on('$routeChangeSuccess', function(event, current, previous) { // $on per agganciare degli eventi, current e previous fanno riferimento alle sole rotte definite in app.js e non a tutta la pagina\n        previousRoute = previous.$$route; // $$ variabile privata\n        currentRoute = current.$$route;\n    });\n    function isFirstView() {\n        return !currentRoute;\n    }\n    function isBackward() {\n        return previousRoute && previousRoute.isForward;\n    }\n    return {\n        enter: function(element, done) {\n            if (isFirstView()) {\n                // FIRST ENTERING ANIMATION\n                dynamics.css(element[0], {\n                    translateY: 0,\n                    opacity: 0,\n                    scale: 1.2,\n                });\n                dynamics.animate(element[0], {\n                    translateY: 0,\n                    opacity: 1,\n                    scale: 1,\n                }, bezierOptions);\n            } else if (isBackward()) {\n                // BACKWARD ENTERING ANIMATION\n                var w = element[0].offsetWidth;\n                dynamics.css(element[0], {\n                    translateX: -w\n                });\n                dynamics.animate(element[0], {\n                    translateX: 0\n                }, bezierOptions);\n            } else {\n                // FORWARD ENTERING ANIMATION\n                var w = element[0].offsetWidth;\n                dynamics.css(element[0], {\n                    translateX: w\n                });\n                dynamics.animate(element[0], {\n                    translateX: 0\n                }, bezierOptions);\n            }\n            done();\n        },\n        leave: function(element, done) {\n            if (isBackward()) {\n                // BACKWARD EXITING ANIMATION\n                var w = element[0].offsetWidth;\n                dynamics.css(element[0], {\n                    translateX: 0\n                });\n                dynamics.animate(element[0], {\n                    translateX: w\n                }, bezierOptions);\n            } else {\n                // FORWARD EXITING ANIMATION\n                var w = element[0].offsetWidth;\n                dynamics.css(element[0], {\n                    translateX: 0\n                });\n                dynamics.animate(element[0], {\n                    translateX: -w\n                }, bezierOptions);\n            }\n            setTimeout(done, 1000);\n        }\n    }\n}]);\n/*global angular,FB */\n\nvar LESSON = true;\nvar CONFIG = {\n    CLIENT: window.location.href.indexOf('http://ulloclient.wslabs.it') === 0 ? 'http://ulloclient.wslabs.it' : 'http://dev.ullowebapp:8081',\n    API: (LESSON || window.location.href.indexOf('http://ulloclient.wslabs.it') === 0) ? 'http://ulloapi.wslabs.it' : 'https://localhost:44302',\n    FACEBOOK_APP_ID: window.location.href.indexOf('http://ulloclient.wslabs.it') === 0 ? '1054303094614120' : '1062564893787940',\n    assetTypeEnum: {\n        Unknown: 0,\n        Picture: 1,\n    },\n    IOS: (navigator.userAgent.match(/iPad|iPhone|iPod/g) ? true : false),\n};\n\napp.constant('APP', CONFIG);\n\napp.config(['$routeProvider', '$locationProvider', function ($routeProvider, $locationProvider) {\n\n\t// SECURE ROUTING\n    $routeProvider.when('/stream', {\n        title: 'Stream',\n        templateUrl: 'templates/stream.html',\n        controller: 'StreamCtrl',\n        controllerAs: 'streamCtrl',\n        resolve: {\n            user: ['Users', function(Users){\n                return Users.isLoggedOrGoTo('/splash');\n            }]\n        },\n\n    }).when('/dishes/:dishId', {\n        title: 'Dish',\n        templateUrl: 'templates/dish.html',\n        controller: 'DishCtrl',\n        controllerAs: 'dishCtrl',\n        resolve: {\n            user: ['Users', function(Users){\n                return Users.isLoggedOrGoTo('/splash');\n            }]\n        },\n        isForward: true,\n\n    }).when('/categories/:categoryId', {\n        title: 'Category',\n        templateUrl: 'templates/category.html',\n        controller: 'CategoryCtrl',\n        controllerAs: 'categoryCtrl',\n        resolve: {\n            user: ['Users', function(Users){\n                return Users.isLoggedOrGoTo('/splash');\n            }]\n        },\n        isForward: true,\n\n    }).when('/users/:userRoute', {\n        title: 'User',\n        templateUrl: 'templates/user.html',\n        controller: 'UserCtrl',\n        controllerAs: 'userCtrl',\n        resolve: {\n            user: ['Users', function(Users){\n                return Users.isLoggedOrGoTo('/splash');\n            }]\n        },\n        isForward: true,\n\n    }).when('/post', {\n        title: 'Add Post',\n        templateUrl: 'templates/post.html',\n        controller: 'PostCtrl',\n        controllerAs: 'postCtrl',\n        resolve: {\n            user: ['Users', function(Users){\n                return Users.isLoggedOrGoTo('/splash');\n            }]\n        },\n        isForward: true,\n\n    }).when('/settings', {\n        title: 'Settings',\n        templateUrl: 'templates/settings.html',\n        controller: 'SettingsCtrl',\n        controllerAs: 'settingsCtrl',\n        resolve: {\n            user: ['Users', function(Users){\n                return Users.isLoggedOrGoTo('/splash');\n            }]\n        },\n        isForward: true,\n\n\t// UNSECURE ROUTING\n    }).when('/splash', {\n        title: 'Splash',\n        templateUrl: 'templates/splash.html',\n        controller: 'SplashCtrl',\n        controllerAs: 'splashCtrl',\n\n    }).when('/signin', {\n        title: 'Sign In',\n        templateUrl: 'templates/signin.html',\n        controller: 'SigninCtrl',\n        controllerAs: 'signinCtrl',\n\n    }).when('/signup', {\n        title: 'Sign Up',\n        templateUrl: 'templates/signup.html',\n        controller: 'SignupCtrl',\n        controllerAs: 'signupCtrl',\n\n    }).when('/test', {\n        title: 'Test',\n        templateUrl: 'templates/dishes.html',\n        controller: 'TestCtrl',\n        controllerAs: 'testCtrl',\n\n    }).when('/404', {\n\n        title: 'Error 404',\n        templateUrl: '404.html',\n\n    });\n\n    $routeProvider.otherwise('/stream');\n\n    // HTML5 MODE url writing method (false: #/anchor/use, true: /html5/url/use)\n    $locationProvider.html5Mode(true);\n\n}]);\n\napp.config(['$httpProvider', function ($httpProvider) {\n    \n    $httpProvider.defaults.withCredentials = true;\n    \n}]);\n\n/*global angular,FB */\n\n/*global angular,FB,dynamics*/\n\n/**\n   * @ngdoc directive\n   * @name onTap\n   * @kind function\n   * @requires $timeout\n   *\n   * @description\n   * When called, it add a class named 'tapped' on element and removes it after a timeout of 500 ms\n   *\n   * @example\n   <example module=\"examples\">\n      <file name=\"index.html\">\n         <button type=\"button\" on-tap>Tap me!</button>\n      </file>\n      <file name=\"script.js\">\n         angular.module('examples', ['wsUtils']);\n      </file>\n      <file name=\"style.css\">\n         .tapped {\n            background: red;\n         }\n      </file>\n   </example>\n*/\n\n// le direttive servono per manipolare il dom\napp.directive('onTap', ['$timeout', function($timeout) { // camelcase qui, l'attributo nell'html invece ha un trattino => on-tap\n   return {\n      restrict: 'A', // A => valida solo come attributo, AEC valida come attributo, elemento e classe <on-tap class=\"on-tap\" on-tap></on-tap>\n      link: function(scope, element, attributes, model) {\n         function onTap(e) {\n            console.log(attributes);\n            element.addClass('tapped');\n            $timeout(function() {\n               element.removeClass('tapped');\n            }, 500)\n         };\n         function addListeners() {\n            element.on('touchstart mousedown', onTap);\n         };\n         function removeListeners() {\n            element.off('touchstart mousedown', onTap);\n         };\n         scope.$on('$destroy', function() {\n            removeListeners();\n         });\n         addListeners();\n      }\n   }\n}]);\n\n/**\n   * @ngdoc directive\n   * @name animate\n   * @kind function\n   * @requires $timeout\n   *\n   * @description\n   * When called, it add a class named 'animated' on element\n   *\n   * @param {string} [animate=fadeIn] a comma separated animate.css class names\n   * @param {string} [delay=1] a comma separated durations list in milliseconds\n   *\n   * @example\n   <example module=\"examples\">\n      <file name=\"index.html\">\n         <div type=\"button\" animate=\"fadeInUp\" delay=\"1000\">\n            I'm an animated div.\n         </div>\n      </file>\n      <file name=\"script.js\">\n         angular.module('examples', ['wsUtils']);\n      </file>\n   </example>\n*/\napp.directive('animate', ['$timeout', function($timeout) {\n   return {\n      restrict: 'A',\n      link: function(scope, element, attributes, model) {\n         element.addClass('animated');\n         var animate = ['fadeIn'], delays = ['1'];\n         if (attributes.animate !== undefined) {\n            animate = attributes.animate.split(',');\n         }\n         if (attributes.delay !== undefined) {\n            delays = attributes.delay.split(',');\n         }\n         angular.forEach(delays, function(d, i) {\n            delays[i] = parseInt(d);\n         });\n         while (delays.length < animate.length) {\n            delays.push(delays[delays.length - 1] + 50);\n         }\n         var removeClasses = animate.join(' ');\n         if (animate[0].indexOf('In') !== -1) {\n            element.addClass('invisible');\n            removeClasses += ' invisible';\n         }\n         while (animate.length) {\n            var d = delays.shift();\n            var a = animate.shift();\n            $timeout(function() {\n               element.removeClass(removeClasses);\n               element.addClass(a);\n               if (animate.length === 0 && a.indexOf('Out') !== -1) {\n                  $timeout(function() {\n                     element.addClass('invisible');\n                  }, 1000);\n               }\n            }, d);\n         }\n      }\n   }\n}]);\n\n/**\n   * @ngdoc directive\n   * @name scrollable\n   * @kind function\n   *\n   * @description\n   * Scrollable div 3d accellerated with touch functionality and callbacks for infinite scroll\n   *\n   * @param {promise} [on-top] optional callback function that execute when reaching top\n   * @param {promise} [on-bottom] optional callback function that execute when reaching bottom\n   *\n   * @example\n   <example module=\"examples\">\n      <file name=\"index.html\">\n         <div ng-controller=\"TestCtrl\">\n            <section class=\"scrollable content\" scrollable on-top=\"$root.doRefresh()\">\n               <div class=\"inner\">\n                  <ul>\n                     <li ng-repeat=\"item in [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]\">item <span ng-bind=\"item\"></span></li>\n                  </ul>\n               </div>\n            </section>\n         </div>\n      </file>\n      <file name=\"script.js\">\n         angular.module('examples', ['wsUtils']);\n         angular.controller('TestCtrl', ['$scope', '$q', function($scope, $q) {\n            $scope.doRefresh = function() {\n               var deferred = $q.defer();\n               if ($scope.busy) {\n                  deferred.reject();\n               } else {\n                  $scope.busy = true;\n                  $timeout(function() {\n                     $scope.busy = false;\n                     deferred.resolve();\n                  }, 500);\n               }\n               return deferred.promise;\n            };\n         }]);\n      </file>\n      <file name=\"style.css\">\n         .scrollable.content {\n            height: 200px!important;\n         }\n      </file>\n   </example>\n*/\napp.directive('scrollable', ['$parse', '$compile', '$window', '$timeout', 'Utils', function($parse, $compile, $window, $timeout, Utils) {\n   return {\n      restrict: 'A',\n      link: function(scope, element, attributes, model) {\n         $window.ondragstart = function() { return false; };\n         // CONSTS;\n         var padding = 150;\n         // FLAGS;\n         var dragging, wheeling, busy;\n         // MOUSE;\n         var down, move, prev, up;\n         // COORDS;\n         var sy = 0, ey = 0, cy = 0, ltop = 0, lbottom = 0, speed = 0, ix = 45, iy = 0;\n         // ANIMATION KEY;\n         var aKey;\n         var onTop, onBottom, showIndicatorFor;\n         if (attributes.onTop !== undefined) {\n            onTop = $parse(attributes.onTop, /* interceptorFn */ null, /* expensiveChecks */ true);\n         }\n         if (attributes.onBottom !== undefined) {\n            onBottom = $parse(attributes.onBottom, /* interceptorFn */ null, /* expensiveChecks */ true);\n         }\n         if (attributes.showIndicatorFor !== undefined) {\n            showIndicatorFor = scope.$eval(attributes.showIndicatorFor); // $parse(attributes.showIndicatorFor, /* interceptorFn */ null, /* expensiveChecks */ true);\n         }\n         // console.log('showIndicatorFor', showIndicatorFor);\n         // ELEMENTS & STYLESHEETS;\n         element.attr('unselectable', 'on').addClass('unselectable');\n         var inner = element.find('div');\n         var innerStyle = new Utils.Style();\n         var indicator = null, indicatorStyle;\n         if (showIndicatorFor) {\n            indicator = angular.element('<div class=\"indicator\"></div>');\n            indicatorStyle = new Utils.Style();\n            element.append(indicator);\n            $compile(indicator.contents())(scope);\n            indicatorStyle.transform('translate3d(' + ix.toFixed(2) + 'px,' + iy.toFixed(2) + 'px,0)');\n            indicatorStyle.set(indicator[0]);\n         }\n         function doTop() {\n            if (busy) {\n               return;\n            }\n            if (!onTop) {\n               return;\n            }\n            busy = true;\n            scope.$apply(onTop).then().finally(function() {\n               sy = ey = 0;\n               setTimeout(function() {\n                  undrag();\n                  busy = false;\n               }, 500);\n            });\n         }\n         function doBottom() {\n            if (busy) {\n               return;\n            }\n            if (!onBottom) {\n               return;\n            }\n            busy = true;\n            scope.$apply(onBottom).then().finally(function() {\n               var lbottom2 = element[0].offsetHeight - inner[0].offsetHeight;\n               if (lbottom2 > lbottom) {\n                  sy = ey = lbottom;\n               } else {\n                  sy = ey = lbottom + padding;\n               }\n               setTimeout(function() {\n                  undrag();\n                  busy = false;\n               }, 500);\n            });\n         }\n         function undrag() {\n            // console.log('undrag');\n            dragging = false;\n            wheeling = false;\n            move = null;\n            down = null;\n            removeDragListeners();\n         }\n         function bounce() {\n            ltop += padding;\n            lbottom -= padding;\n            if (ey > ltop) {\n               doTop();\n            } else if (ey < lbottom) {\n               doBottom();\n            }\n         }\n         function redraw(time) {\n            // if (!busy) {\n            ltop = 0;\n            lbottom = element[0].offsetHeight - inner[0].offsetHeight;\n            if (dragging) {\n               ey = sy + move.y - down.y;\n               bounce();\n            } else if (speed) {\n               ey += speed;\n               speed *= .75;\n               if (wheeling) {\n                  bounce();\n               }\n               if (Math.abs(speed) < 0.05) {\n                  speed = 0;\n                  ey = sy = cy;\n                  wheeling = false;\n                  pause();\n               }\n            }\n            // }\n            ey = Math.min(ltop, ey);\n            ey = Math.max(lbottom, ey);\n            cy += (ey - cy) / 4;\n            innerStyle.transform('translate3d(0,' + cy.toFixed(2) + 'px,0)');\n            innerStyle.set(inner[0]);\n            if (showIndicatorFor) {\n               if (dragging || wheeling || speed) {\n                  var percent = cy / (element[0].offsetHeight - inner[0].offsetHeight);\n                  percent = Math.max(0, Math.min(1, percent));\n                  iy = (element[0].offsetHeight - indicator[0].offsetHeight) * (percent);\n                  ix += (0 - ix) / 4;\n                  // var count = Math.round(inner[0].offsetHeight / 315);\n                  var i = Math.max(1, Math.round(percent * showIndicatorFor.rows.length));\n                  indicator.html(i + '/' + showIndicatorFor.count);\n                  // indicator.html((percent * 100).toFixed(2).toString());\n               } else {\n                  ix += (45 - ix) / 4;\n               }\n               indicatorStyle.transform('translate3d(' + ix.toFixed(2) + 'px,' + iy.toFixed(2) + 'px,0)');\n               indicatorStyle.set(indicator[0]);\n            }\n         }\n         function play() {\n            function loop(time) {\n               redraw(time);\n               aKey = window.requestAnimationFrame(loop, element);\n            }\n            if (!aKey) {\n               loop();\n            }\n         }\n         function pause() {\n            if (aKey) {\n               window.cancelAnimationFrame(aKey);\n               aKey = null;\n               // console.log('Animation.paused');\n            }\n         }\n         function onDown(e) {\n            if (!busy) {\n               sy = ey = cy;\n               speed = 0;\n               down = Utils.getTouch(e);\n               wheeling = false;\n               // console.log(down);\n               addDragListeners();\n               play();\n            }\n         }\n         function onMove(e) {\n            prev = move;\n            move = Utils.getTouch(e);\n            dragging = true;\n            // console.log(move);\n         }\n         function onUp(e) {\n            if (move && prev) {\n               speed += (move.y - prev.y) * 4;\n            }\n            sy = ey = cy;\n            dragging = false;\n            move = null;\n            down = null;\n            prev = null;\n            up = Utils.getTouch(e);\n            // console.log(up);\n            removeDragListeners();\n         }\n         function _onWheel(e) {\n            if (!busy) {\n               if (!e) e = event;\n               var dir = (((e.deltaY < 0 || e.wheelDelta > 0) || e.deltaY < 0) ? 1 : -1)\n               /*\n               var evt = window.event || e;\n               var delta = evt.detail ? evt.detail * -120 : evt.wheelDelta\n               speed += delta;\n               */\n               speed += dir * 5;\n               wheeling = true;\n               play();\n            }\n         }\n         var onWheel = Utils.throttle(_onWheel, 25);\n         function addListeners() {\n            element.on('touchstart mousedown', onDown);\n            element.on('wheel', onWheel);\n            // element.addEventListener('DOMMouseScroll',handleScroll,false); // for Firefox\n            // element.addEventListener('mousewheel',    handleScroll,false); // for everyone else\n         };\n         function removeListeners() {\n            element.off('touchstart mousedown', onDown);\n            element.off('wheel', onWheel);\n         };\n         function addDragListeners() {\n            angular.element($window).on('touchmove mousemove', onMove);\n            angular.element($window).on('touchend mouseup', onUp);\n         };\n         function removeDragListeners() {\n            angular.element($window).off('touchmove mousemove', onMove);\n            angular.element($window).off('touchend mouseup', onUp);\n         };\n         scope.$on('$destroy', function() {\n            removeListeners();\n         });\n         addListeners();\n      },\n   };\n}]);\n\n/**\n   * @ngdoc directive\n   * @name ngImg\n   * @kind function\n   *\n   * @description\n   * Whenever the image has loaded, a loaded class will be added to the image element\n   *\n   * @param {string} ng-img path to the image to load\n   *\n   * @example\n   <example module=\"examples\">\n      <file name=\"index.html\">\n         <img src=\"\" ng-img=\"'/img/nature-01.jpg'\"/>\n      </file>\n      <file name=\"script.js\">\n         angular.module('examples', ['wsUtils']);\n      </file>\n      <file name=\"style.css\">\n         [ng-img] {\n            max-width: 100%;\n            opacity: 0;\n            transition: opacity ease-in-out 250ms;\n         }\n         [ng-img].loaded {\n            opacity: 1;\n         }\n      </file>\n   </example>\n*/\napp.directive('ngImg', ['$parse', '$timeout', function($parse, $timeout) {\n   return {\n      restrict: 'A',\n      link: function(scope, element, attributes, model) {\n         var src = $parse(attributes.ngImg, /* interceptorFn */ null, /* expensiveChecks */ true);\n         var image = new Image();\n         image.onload = function() {\n            attributes.$set('src', this.src);\n            setTimeout(function() {\n               element.addClass('loaded');\n            }, 10);\n         }\n         image.load = function(src) {\n            element.removeClass('loaded');\n            this.src = src;\n         }\n         scope.$watch(src, function(newValue) {\n            if (!newValue) {\n               attributes.$set('src', null);\n            } else {\n               image.load(newValue);\n            }\n         });\n      }\n   };\n}]);\n\n/**\n   * @ngdoc directive\n   * @name ngImgWorker\n   * @kind function\n   *\n   * @description\n   * As ngImg but using webworker. Whenever the image has loaded, a loaded class will be added to the image element\n   *\n   * @param {string} ng-img path to the image to load\n   *\n   * @example\n\t<example module=\"examples\">\n      <file name=\"index.html\">\n         <img src=\"\" ng-img-worker=\"'/img/nature-02.jpg'\"/>\n      </file>\n      <file name=\"script.js\">\n         angular.module('examples', ['wsUtils']);\n      </file>\n      <file name=\"style.css\">\n         [ng-img] {\n            max-width: 100%;\n            opacity: 0;\n            transition: opacity ease-in-out 250ms;\n         }\n         [ng-img].loaded {\n            opacity: 1;\n         }\n      </file>\n\t</example>\n*/\napp.directive('ngImgWorker', ['$parse', 'WebWorker', function($parse, WebWorker) {\n   var worker = new WebWorker('/js/workers/loader.min.js');\n   return {\n      restrict: 'A',\n      link: function(scope, element, attributes, model) {\n         function doWork(src) {\n            element.removeClass('loaded');\n            function onImageLoaded(src) {\n               attributes.$set('src', src);\n               setTimeout(function() {\n                  element.addClass('loaded');\n               }, 100);\n            }\n            worker.post({ url: src }).then(function(data) {\n               onImageLoaded(data.url);\n            }, function(error) {\n               onImageLoaded(null);\n            });\n         }\n         var src = scope.$eval(attributes.ngImgWorker);\n         if (!src) {\n            attributes.$set('src', null);\n         } else {\n            doWork(src);\n         }\n      }\n   };\n}]);\n\n/**\n   * @ngdoc directive\n   * @name control\n   * @kind function\n   *\n   * @description\n   * Dinamic form control generator through templates with extended validation\n   *\n   * @param {string} model the target model of control\n   * @param {string} [control=text] the type of control, available types (text, password, email, number, checkbox, textarea, datetime-local, select, autocomplete)\n   * @param {string} [form=Form] the name of the form\n   * @param {string} [title=Untitled] the title of the control\n   * @param {string} [placeholder=title] the placeholder of the control\n   * @param {string} [source=null] datasource of select as array\n   * @param {string} [key=id] optional key for select option\n   * @param {string} [label=name] optional label for select option\n   * @param {string} [required=false] if the control is required\n   *\n   * @example\n   <example module=\"examples\">\n      <file name=\"index.html\">\n         <div class=\"container-fluid\">\n            <div class=\"row\">\n               <form name=\"myForm\">\n                  <div class=\"form-group col-xs-12\" form=\"myForm\" control=\"select\" title=\"category\" placeholder=\"select a category\" model=\"model.category\" source=\"[{name:'Main',id:1}, {name:'Second',id:2}]\" required=\"true\"></div>\n                  <div class=\"form-group col-xs-12\" form=\"myForm\" control=\"number\" title=\"dish price\" placeholder=\"type the price of the dish\" model=\"model.dish.price\" required=\"true\"></div>\n                  <div class=\"form-group col-xs-12\" form=\"myForm\" control=\"checkbox\" title=\"is vegan friendly\" placeholder=\"please check if the dish is vegan friendly\" model=\"model.dish.isVeganFriendly\"></div>\n               </form>\n            </div>\n         </div>\n      </file>\n      <file name=\"script.js\">\n         angular.module('examples', ['wsUtils']);\n      </file>\n   </example>\n*/\napp.directive('control', [function() {\n   return {\n      restrict: 'A',\n      replace: true,\n      template: function(element, attributes) {\n         var form = attributes.form || 'Form';\n         var title = attributes.title || 'Untitled';\n         var placeholder = attributes.placeholder || title;\n         var name = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('');\n         var formKey = form + '.' + name;\n         var formFocus = ' ng-focus=\"' + formKey + '.hasFocus=true\" ng-blur=\"' + formKey + '.hasFocus=false\"';\n         var required = '';\n         var label = (attributes.label ? attributes.label : 'name');\n         var key = (attributes.key ? attributes.key : 'id');\n         var model = attributes.model;\n         if (attributes.required) {\n            required = '<span ng-messages=\"' + (attributes.readonly ? '' : '(' + form + '.$submitted || ' + formKey + '.$touched) && ') + form + '.' + name + '.$error\" role=\"alert\"><span ng-message=\"required\" class=\"label-error animated flash\"> &larr; required</span>';\n            switch (attributes.control) {\n               case 'password':\n                  required = required + '<span ng-message=\"minlength\" class=\"label-error animated flash\"> &larr; at least 6 chars</span>';\n                  break;\n               case 'email':\n                  required = required + '<span ng-message=\"email\" class=\"label-error animated flash\"> &larr; incorrect</span>';\n                  break;\n               case 'number':\n                  required = required + '<span ng-message=\"number\" class=\"label-error animated flash\"> &larr; enter a valid number</span>';\n                  break;\n            }\n            if (attributes.match !== undefined) {\n               required = required + '<span ng-message=\"match\" class=\"label-error animated flash\"> &larr; not matching</span>';\n            }\n            required = required + '</span>';\n         } else {\n            required = ' (optional)';\n         }\n         var template = '<div ' + (attributes.readonly ? ' class=\"readonly\" ' : '') + ' ng-class=\"{ focus: ' + formKey + '.hasFocus, success: ' + formKey + '.$valid, error: ' + formKey + '.$invalid && (form.$submitted || ' + formKey + '.$touched), empty: !' + formKey + '.$viewValue }\"><label for=\"' + name + '\" class=\"control-label\">' + title + required + '</label>';\n         switch (attributes.control) {\n            case 'checkbox':\n               template = '<div class=\"checkbox\">';\n               template += '<span class=\"checkbox-label\">' + title + required + '</span>';\n               template += '<span class=\"switch\"><input id=\"' + name + '\" name=\"' + name + '\" type=\"checkbox\" ng-model=\"' + model + '\" ' + (attributes.required ? 'required=\"true\"' : '') + ' class=\"toggle toggle-round-flat\"><label for=\"' + name + '\"></label></span>';\n               template += '</div>';\n               break;\n            case 'select':\n               var options = attributes.number\n                  ? 'item.' + key + ' as item.' + label + ' for item in ' + attributes.source\n                  : 'item.' + label + ' for item in ' + attributes.source + ' track by item.' + key;\n               template += '<select name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\" ng-options=\"' + options + '\" ' + (attributes.number ? 'convert-to-number' : '') + ' ' + (attributes.required ? 'required=\"true\"' : '') + '><option value=\"\" disabled selected hidden>' + placeholder + '</option></select>';\n               break;\n            case 'autocomplete':\n               var canCreate = (attributes.canCreate ? attributes.canCreate : false);\n               var flatten = (attributes.flatten ? attributes.flatten : false);\n               var queryable = (attributes.queryable ? attributes.queryable : false);\n               var onSelected = (attributes.onSelected ? ' on-selected=\"' + attributes.onSelected + '\"' : '');\n               template += '<input name=\"' + name + '\" ng-model=\"' + model + '\" type=\"hidden\" ' + (attributes.required ? 'required' : '') + '>';\n               template += '<div control-autocomplete=\"' + attributes.source + '\" model=\"' + model + '\" label=\"' + label + '\"  key=\"' + key + '\" can-create=\"' + canCreate + '\" flatten=\"' + flatten + '\" queryable=\"' + queryable + '\" placeholder=\"' + placeholder + '\" on-focus=\"' + formKey + '.hasFocus=true\" on-blur=\"' + formKey + '.hasFocus=false\"' + onSelected + '></div>';\n               break;\n            case 'textarea':\n               template += '<textarea name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" ' + (attributes.required ? 'required' : '') + ' rows=\"' + (attributes.rows ? attributes.rows : '1') + '\"' + formFocus + '></textarea>';\n               break;\n            case 'datetime-local':\n               placeholder == title ? placeholder = 'yyyy-MM-ddTHH:mm:ss' : null;\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"datetime-local\"' + (attributes.required ? ' required' : '') + (attributes.readonly ? ' readonly' : '') + formFocus + '>';\n               break;\n            case 'password':\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"password\" ng-minlength=\"6\" ' + (attributes.required ? 'required' : '') + formFocus + '>';\n               break;\n            case 'email':\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"email\" ' + (attributes.required ? 'required' : '') + formFocus + '>';\n               break;\n            case 'number':\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"text\"' + (attributes.required ? ' required' : '') + (attributes.readonly ? ' readonly' : '') + formFocus + ' validate-type=\"number\">'; // ' validator=\"{ number: isNumber }\">';\n               break;\n            case 'text':\n            default:\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"text\"' + (attributes.required ? ' required' : '') + (attributes.readonly ? ' readonly' : '') + formFocus + '>';\n               break;\n         }\n         return template + '</div>';\n      },\n      link: function(scope, element, attributes, model) {\n      },\n   };\n}]);\n\n/**\n   * @ngdoc directive\n   * @name controlAutocomplete\n   * @kind function\n   * @requires ngModel\n   *\n   * @description\n   * Custom control type with autocomplete functionality. (use the shortcut version with control directive)\n   *\n   * @param {service} controlAutocomplete the datasource service\n   * @param {model} model the target model of control\n   * @param {boolean} [canCreate=false] setted on true the control can add new entities\n   * @param {boolean} [flatten=false] set to true to flat the value to the model\n   * @param {boolean} [queryable=false] set to true if is a queryable service\n   * @param {string} [key=id] optional key for select option\n   * @param {string} [label=name] optional label for select option\n   *\n   * @example\n   <example module=\"examples\">\n      <file name=\"index.html\">\n         <div class=\"container-fluid\">\n            <div class=\"row\">\n               <form name=\"myForm\">\n                  <div class=\"form-group col-xs-12 empty focus\">\n                     <label for=\"dishname\" class=\"control-label\">dish name<span ng-messages=\"(myForm.$submitted || myForm.dishname.$touched) &amp;&amp; myForm.dishname.$error\" role=\"alert\" class=\"ng-inactive\"></span></label>\n                     <input name=\"dishname\" ng-model=\"model.name\" type=\"hidden\" required=\"\">\n                     <div control-autocomplete=\"dishesAutocomplete\" model=\"model.name\" label=\"name\" key=\"name\" can-create=\"true\" flatten=\"true\" queryable=\"false\" placeholder=\"type the name of the dish\" on-focus=\"myForm.dishname.hasFocus=true\" on-blur=\"myForm.dishname.hasFocus=false\" on-selected=\"onDishSelected($item)\" class=\"ng-isolate-scope\"></div>\n               </form>\n            </div>\n         </div>\n      </file>\n      <file name=\"script.js\">\n         angular.module('examples', ['wsUtils']);\n         angular.run(['$rootScope', '$q', function($rootScope, $q) {\n            $rootScope.dishesAutocomplete = ;\n            $rootScope.onDishSelected = function($item) {\n               alert($item);\n            };\n         }]);\n      </file>\n   </example>\n*/\napp.directive('controlAutocomplete', ['$parse', '$window', '$timeout', 'Utils', function($parse, $window, $timeout, Utils) {\n   var MAX_ITEMS = 5;\n   return {\n      restrict: 'A',\n      scope: {\n         service: '=controlAutocomplete',\n         canCreate: '=',\n         flatten: '=',\n         queryable: '=',\n         model: '=',\n         label: '@',\n         key: '@',\n      },\n      template: function(element, attributes) {\n         var template = '<div>';\n         template += '   <input class=\"form-control\" ng-model=\"phrase\" ng-model-options=\"{ debounce: 150 }\" placeholder=\"' + attributes.placeholder + '\" type=\"text\" ng-focus=\"onFocus()\">';\n         template += '   <ul class=\"form-autocomplete\" ng-show=\"items.length\">';\n         template += '       <li ng-repeat=\"item in items\" ng-class=\"{ active: active == $index }\" ng-click=\"onSelect(item)\">';\n         template += '           <span>{{item.NameA}}<span class=\"token\">{{item.NameB}}</span>{{item.NameC}}</span>';\n         template += '       </li>';\n         template += '   </ul>';\n         template += '</div>';\n         return template;\n      },\n      link: function(scope, element, attributes, model) {\n         var onSelected = $parse(attributes.onSelected);\n         var input = element.find('input');\n         var label = (scope.label ? scope.label : 'name');\n         var key = (scope.key ? scope.key : 'id');\n         function getPhrase() {\n            if (scope.model) {\n               return scope.flatten ? scope.model : scope.model[label];\n            } else {\n               return null;\n            }\n         }\n         scope.phrase = getPhrase();\n         scope.count = 0;\n         scope.items = [];\n         scope.active = -1;\n         scope.maxItems = scope.maxItems || Number.POSITIVE_INFINITY;\n         function Clear(phrase) {\n            scope.items.length = 0;\n            scope.count = 0;\n            scope.phrase = phrase || null;\n            input.val(scope.phrase);\n         }\n         function Current() {\n            var current = null;\n            if (scope.active != -1 && scope.items.length > scope.active) {\n               current = scope.items[scope.active];\n            }\n            return current;\n         }\n         scope.onFocus = function() {\n            if (attributes.onFocus !== undefined) {\n               scope.$parent.$eval(attributes.onFocus);\n            }\n            if (input.val() === getPhrase()) {\n               input.val(null);\n            }\n         };\n         scope.onBlur = function() {\n            if (attributes.onBlur !== undefined) {\n               scope.$parent.$eval(attributes.onBlur);\n            }\n            Clear(getPhrase());\n         };\n         scope.onSelect = function(item) {\n            if (scope.queryable) {\n               scope.service.setItem(item).then(function(parsedItem) {\n                  onSelected({ $item: parsedItem }, scope.$parent, { $event: {} });\n                  $timeout(function() {\n                     if (scope.flatten) {\n                        scope.model = parsedItem[key];\n                     } else {\n                        scope.model = scope.model || {};\n                        angular.extend(scope.model, parsedItem);\n                     }\n                     scope.onBlur();\n                  }, 1);\n               });\n            } else {\n               onSelected({ $item: item }, scope.$parent, { $event: {} });\n               if (scope.flatten) {\n                  scope.model = item[key];\n               } else {\n                  scope.model = scope.model || {};\n                  angular.extend(scope.model, item);\n               }\n               scope.onBlur();\n            }\n         };\n         function onTyping(phrase) {\n            if (scope.canCreate) {\n               if (scope.flatten) {\n                  if (key === label) {\n                     scope.model = phrase;\n                  }\n               } else {\n                  scope.model = {};\n                  scope.model[label] = phrase;\n               }\n            }\n         };\n         function Enter() {\n            var item = Current();\n            if (item) {\n               scope.onSelect(item);\n            }\n            scope.$apply();\n         }\n         function Up() {\n            scope.active--;\n            if (scope.active < 0) {\n               scope.active = scope.items.length - 1;\n            }\n            scope.$apply();\n         }\n         function Down() {\n            scope.active++;\n            if (scope.items.length == 0) {\n               scope.active = -1;\n            } else if (scope.active >= scope.items.length) {\n               scope.active = 0;\n            }\n            scope.$apply();\n         }\n         function Parse(data) {\n            scope.items = data.items;\n            scope.count = data.count;\n            angular.forEach(scope.items, function(value, index) {\n               var name = value[label];\n               var i = name.toLowerCase().indexOf(scope.phrase.toLowerCase());\n               value.NameA = name.substr(0, i);\n               value.NameB = name.substr(i, scope.phrase.length);\n               value.NameC = name.substr(i + scope.phrase.length, name.length - (i + scope.phrase.length));\n            });\n         }\n         function Filter(data) {\n            var c = 0, i = [];\n            if (scope.phrase.length > 1) {\n               angular.forEach(data.items, function(value, index) {\n                  var name = value[label];\n                  if (name.toLowerCase().indexOf(scope.phrase.toLowerCase()) !== -1) {\n                     if (i.length < MAX_ITEMS) {\n                        i.push(value);\n                     }\n                     c++;\n                  }\n               });\n            }\n            Parse({\n               count: c,\n               items: i\n            });\n         }\n         function Search() {\n            scope.phrase = input.val();\n            scope.active = -1;\n            onTyping(scope.phrase);\n            if (scope.queryable) {\n               scope.service.setPhrase(scope.phrase).then(function(success) {\n                  scope.items = success.items;\n                  scope.count = success.count;\n               }, function(error) {\n                  console.log('Search.queryable.error', scope.phrase, error);\n               }).finally(function() {\n\n               });\n            } else {\n               Filter({\n                  count: scope.service.length,\n                  items: scope.service\n               });\n               scope.$apply();\n            }\n         }\n         function onKeyDown(e) {\n            switch (e.keyCode) {\n               case 9: // Tab\n               case 13: // Enter\n                  Enter();\n                  if (scope.items.length) {\n                     e.preventDefault ? e.preventDefault() : null;\n                     return false;\n                  }\n                  break;\n               case 38: // Up\n                  Up();\n                  break;\n               case 40: // Down\n                  Down();\n                  break;\n            }\n         }\n         function onKeyUp(e) {\n            switch (e.keyCode) {\n               case 9: // Tab\n               case 13: // Enter\n                  break;\n               case 39: // Right\n                  break;\n               case 37: // Left\n                  break;\n               case 38: // Up\n                  break;\n               case 40: // Down\n                  break;\n               default: // Text\n                  Search.call(this);\n                  break;\n            }\n         }\n         function onUp(e) {\n            if (Utils.getClosest(e.target, '[control-autocomplete]') === null) {\n               scope.$apply(function() {\n                  scope.onBlur();\n               });\n            }\n            return true;\n         }\n         function addListeners() {\n            input.on('keydown', onKeyDown);\n            input.on('keyup', onKeyUp);\n            angular.element($window).on('mouseup touchend', onUp);\n         };\n         function removeListeners() {\n            input.off('keydown', onKeyDown);\n            input.off('keyup', onKeyUp);\n            angular.element($window).off('mouseup touchend', onUp);\n         };\n         scope.$on('$destroy', function() {\n            removeListeners();\n         });\n         var init = false;\n         function Init() {\n            if (!init) {\n               addListeners();\n               init = true;\n            }\n         }\n         scope.$watch('service', function(newValue) {\n            if (newValue && (newValue.length || scope.queryable)) {\n               Init();\n            }\n         });\n         scope.$watchCollection('model', function(newValue) {\n            if (newValue) {\n               if (scope.flatten && label === key) {\n                  scope.phrase = newValue;\n                  input.val(scope.phrase);\n               } else if (newValue[label]) {\n                  scope.phrase = newValue[label];\n                  input.val(scope.phrase);\n               }\n            }\n         });\n      },\n   };\n}]);\n\n/**\n   * @ngdoc directive\n   * @name validateType\n   * @kind function\n   * @requires ngModel\n   *\n   * @description\n   * Custom validation type for ngModel\n   *\n   * @param {string} [validateType=number] the type of custom validation\n   *\n   * @example\n\t<example module=\"examples\">\n\t\t<file name=\"index.html\">\n\t\t\t<form name=\"myForm\">\n\t\t\t\t<input name=\"myValue\" type=\"text\" ng-model=\"model\" validate-type=\"number\" />\n\t\t\t\t<span ng-messages=\"(myForm.$submitted || myForm.$touched) && myForm.myValue.$error\" role=\"alert\">\n\t\t\t\t\t<span ng-message=\"number\" class=\"label-error animated flash\"> &larr; enter a valid number</span>\n\t\t\t\t</span>\n\t\t\t</form>\n\t\t</file>\n\t\t<file name=\"script.js\">\n\t\t\tangular.module('examples', ['wsUtils']);\n\t\t</file>\n\t</example>\n*/\napp.directive('validateType', function() {\n   return {\n      require: 'ngModel',\n      link: function(scope, element, attributes, model) {\n         var type = attributes.validateType;\n         switch (type) {\n            case 'number':\n               model.$parsers.unshift(function(value) {\n                  model.$setValidity(type, String(value).indexOf(Number(value).toString()) !== -1);\n                  return value;\n               });\n               break;\n         }\n      }\n   };\n});\n\napp.filter('customCurrency', ['$filter', function ($filter) {\n    var legacyFilter = $filter('currency');\n    return function (cost, currency) {\n        return legacyFilter(cost * currency.ratio, currency.formatting);\n    }\n}]);\n\napp.filter('customSize', ['APP', function (APP) {\n    return function (inches) {\n        if (APP.unit === APP.units.IMPERIAL) {\n            var feet = Math.floor(inches / 12);\n            inches = inches % 12;\n            inches = Math.round(inches * 10) / 10;\n            return (feet ? feet + '\\' ' : '') + (inches + '\\'\\'');\n        } else {\n            var meters = Math.floor(inches * APP.size.ratio);\n            var cm = (inches * APP.size.ratio * 100) % 100;\n            cm = Math.round(cm * 10) / 10;\n            return (meters ? meters + 'm ' : '') + (cm + 'cm');\n        }\n    };\n}]);\n\napp.filter('customWeight', ['APP', function (APP) {\n    return function (pounds) {\n        if (APP.unit === APP.units.IMPERIAL) {\n            if (pounds < 1) {\n                var oz = pounds * 16;\n                oz = Math.round(oz * 10) / 10;\n                return (oz ? oz + 'oz ' : '');\n            } else {\n                pounds = Math.round(pounds * 100) / 100;\n                return (pounds ? pounds + 'lb ' : '');\n            }\n        } else {\n            var kg = Math.floor(pounds * APP.weight.ratio / 1000);\n            var grams = (pounds * APP.weight.ratio) % 1000;\n            grams = Math.round(grams * 10) / 10;\n            return (kg ? kg + 'kg ' : '') + (grams + 'g');\n        }\n    };\n}]);\n\napp.filter('customNumber', ['$filter', function ($filter) {\n    var filter = $filter('number');\n    return function (value, precision, unit) {\n        unit = unit || '';\n        return (value ? filter(value, precision) + unit : '-');\n    }\n}]);\n\napp.filter('customDate', ['$filter', function ($filter) {\n    var filter = $filter('date');\n    return function (value, format, timezone) {\n        return value ? filter(value, format, timezone) : '-';\n    }\n}]);\n\napp.filter('customTime', ['$filter', function ($filter) {\n    return function (value, placeholder) {\n        if (value) {\n            return Utils.parseTime(value);\n        } else {\n            return (placeholder ? placeholder : '-');\n        }\n    }\n}]);\n\napp.filter('customDigital', ['$filter', function ($filter) {\n    return function (value, placeholder) {\n        if (value) {\n            return Utils.parseHour(value);\n        } else {\n            return (placeholder ? placeholder : '-');\n        }\n    }\n}]);\n\napp.filter('customString', ['$filter', function ($filter) {\n    return function (value, placeholder) {\n        return value ? value : (placeholder ? placeholder : '-');\n    }\n}]);\n\napp.filter('customEnum', function () {\n    return function (val) {\n        val = val + 1;\n        return val < 10 ? '0' + val : val;\n    };\n});\n\n/*global angular,FB */\n\napp.value('UserRoles', [{\n    name: 'Guest', id: 1\n}, {\n    name: 'User', id: 2\n}, {\n    name: 'Supervisor', id: 3\n}, {\n    name: 'Admin', id: 4\n}]);\n\napp.value('UserRolesEnum', {\n    'Guest': 1,\n    'User': 2,\n    'Supervisor': 3,\n    'Admin': 4,\n});\n\napp.factory('User', ['UserRolesEnum', function (UserRolesEnum) {\n    function User(data) {\n        // Extend instance with data\n        data ? angular.extend(this, data) : null;\n    }\n    User.prototype = {\n        // If user instance is in role Administrator\n        isAdmin: function () {\n            return this.role === UserRolesEnum.Admin;\n        },\n        // If user parameters equals user instance\n        isUser: function (user) {\n            return this.email === user.email;\n        },\n        picture: function (size) {\n          size = size || 'sm';\n          var w;\n          switch(size) {\n              case 'sm':\n                w = 50;\n              break;\n              case 'md':\n                w = 300;\n              break;\n              default:\n          }\n          return this.facebookId ? 'https://graph.facebook.com/'+ this.facebookId +'/picture?width=' + w + '&height=' + w + '&type=square' : '/img/avatar-default.png';\n        },\n        backgroundPicture: function(size) {\n            return 'background-image: url(' + this.picture(size) + ');';\n        },\n    };\n    return User;\n}]);\n/*global angular,FB */\n\n/*global angular,FB */\n\napp.factory('FacebookService', ['$q', 'APP', function ($q, APP) {\n\n    function FacebookService() {\n\n    }\n\n    FacebookService.FB = function () {\n        var deferred = $q.defer();\n        if (window['FB'] !== undefined) {\n            deferred.resolve(window['FB']);\n        } else {\n            FacebookService.init().then(function (success) {\n                deferred.resolve(window['FB']);\n            }, function (error) {\n                deferred.reject(error);\n            })\n        }\n        return deferred.promise;\n    }\n\n    FacebookService.getFacebookMe = function () {\n        var deferred = $q.defer();\n\t\tFacebookService.FB().then(function (facebook) {\n            facebook.api('/me', { fields: 'id,name,first_name,last_name,email,gender,picture,cover,link' }, function (response) {\n                if (!response || response.error) {\n                    deferred.reject('Error occured');\n                } else {\n                    deferred.resolve(response);\n                }\n            });\n        });\n        return deferred.promise;\n    };\n\n    FacebookService.getPictureMe = function () {\n        var deferred = $q.defer();\n\t\tFacebookService.FB().then(function (facebook) {\n            facebook.api('/me/picture', { width: 300, height: 300, type: 'square' }, function (response) {\n                if (!response || response.error) {\n                    deferred.reject('Error occured');\n                } else {\n                    deferred.resolve(response);\n                }\n            });\n        });\n        return deferred.promise;\n    };\n\n    FacebookService.getLoginStatus = function () {\n        var deferred = $q.defer();\n\t\tFacebookService.FB().then(function (facebook) {\n            facebook.getLoginStatus(function (response) {\n                onFacebookStatus(response, deferred);\n            });\n        });\n        return deferred.promise;\n    };\n\n    FacebookService.login = function () {\n        var deferred = $q.defer();\n\t\tFacebookService.FB().then(function (facebook) {\n            facebook.login(function (response) {\n                onFacebookStatus(response, deferred);\n            }, {\n                scope: 'public_profile,email' // publish_stream,\n            });\n        });\n        return deferred.promise;\n    };\n\n    FacebookService.logout = function () {\n        var deferred = $q.defer();\n\t\tFacebookService.FB().then(function (facebook) {\n\t\t\tfacebook.logout(function (response) {\n\t\t\t\tdeferred.resolve(response);\n\t\t\t});\n        });\n        return deferred.promise;\n    };\n\n    FacebookService.deletePermissions = function () {\n        var deferred = $q.defer();\n\t\tFacebookService.FB().then(function (facebook) {\n\t\t\tfacebook.api('/me/permissions', 'delete', function (response) {\n\t\t\t\tdeferred.resolve(response);\n            });\n        });\n        return deferred.promise;\n    };\n\n    FacebookService.init = function () {\n        var deferred = $q.defer();\n        window.fbAsyncInit = function () {\n            FB.init({\n                appId: APP.FACEBOOK_APP_ID,\n                status: true,\n                cookie: true,\n                xfbml: true,\n                version: 'v2.5'\n            });\n            deferred.resolve(FB);\n        };\n        try {\n            (function (d, s, id) {\n                var js, fjs = d.getElementsByTagName(s)[0];\n                if (d.getElementById(id)) { return; }\n                js = d.createElement(s); js.id = id;\n                js.src = \"//connect.facebook.net/en_US/sdk.js\";\n                fjs.parentNode.insertBefore(js, fjs);\n            }(document, 'script', 'facebook-jssdk'));\n        } catch (e) {\n            deferred.reject(e);\n        }\n        return deferred.promise;\n    };\n\n    function onFacebookStatus(response, deferred) {\n        FacebookService.authResponse = null;\n        if (response.status === 'connected') {\n            FacebookService.authResponse = response.authResponse;\n            deferred.resolve(response);\n        } else if (response.status === 'not_authorized') {\n            deferred.reject(response);\n        } else {\n            deferred.reject(response);\n        }\n    };\n\n    return FacebookService;\n\n}]);\n\napp.factory('Users', ['$q', '$http', '$location', '$timeout', 'APP', 'LocalStorage', 'User', function ($q, $http, $location, $timeout, APP, LocalStorage, User) {\n\n    // PRIVATE VARIABLE FOR CURRENT USER\n    var _currentUser = null;\n\n    function Users() {\n    }\n\n    Users.prototype = {\n    };\n\n    // STATIC CLASS METHODS\n    Users.currentUser = function () {\n        return _currentUser;\n    };\n\n    Users.getCurrentUser = function () {\n        var deferred = $q.defer();\n        if (_currentUser) {\n            deferred.resolve(_currentUser);\n        } else {\n            $http.get(APP.API + '/api/users/current/').then(function success(response) {\n                if (response && response.data) {\n                    _currentUser = new User(response.data);\n                    deferred.resolve(_currentUser);\n                } else {\n                    deferred.resolve(null); // deferred.reject(null);\n                }\n            }, function error(response) {\n                deferred.reject(response);\n            });\n        }\n        return deferred.promise;\n    };\n\n    Users.isLogged = function () {\n        var deferred = $q.defer();\n        Users.getCurrentUser().then(function (user) {\n            // console.log('Users.isLogged.success', user);\n            user && user.isAuthenticated ? deferred.resolve(user) : deferred.reject();\n        }, function error(response) {\n            // console.log('Users.isLogged.error', data);\n            deferred.reject(response);\n        })\n        return deferred.promise;\n    };\n\n    Users.isAdmin = function () {\n        var deferred = $q.defer();\n        Users.getCurrentUser().then(function (user) {\n            user && user.isAuthenticated && user.isAdmin ? deferred.resolve(user) : deferred.reject();\n        }, function error(response) {\n            deferred.reject(response);\n        })\n        return deferred.promise;\n    };\n\n    Users.isLoggedOrGoTo = function(redirect) {\n        var deferred = $q.defer();\n        Users.getCurrentUser().then(function (user) {\n            // console.log('Users.isLogged.success', user);\n            if (user && user.isAuthenticated) {\n                deferred.resolve(user);\n            } else {\n                deferred.reject();\n                $location.path(redirect);\n            }\n        }, function error(response) {\n            // console.log('Users.isLogged.error', data);\n            deferred.reject(response);\n            $location.path(redirect);\n        })\n        return deferred.promise;\n    };\n\n    Users.isAdminOrGoTo = function(redirect) {\n        var deferred = $q.defer();\n        Users.getCurrentUser().then(function (user) {\n            // console.log('Users.isLogged.success', user);\n            if (user && user.isAuthenticated && user.isAdmin) {\n                deferred.resolve(user);\n            } else {\n                deferred.reject();\n                $location.path(redirect);\n            }\n        }, function error(response) {\n            // console.log('Users.isLogged.error', data);\n            deferred.reject(response);\n            $location.path(redirect);\n        })\n        return deferred.promise;\n    },\n\n    /** LOGIN METHODS **/\n    Users.signup = function (model) {\n        var deferred = $q.defer();\n        $http.post(APP.API + '/api/users/signup/', model).then(function success(response) {\n            _currentUser = new User(response.data);\n            deferred.resolve(_currentUser);\n        }, function error(response) {\n            deferred.reject(response);\n        });\n        return deferred.promise;\n    };\n\n    Users.signin = function (model) {\n        var deferred = $q.defer();\n        $http.post(APP.API + '/api/users/signin/', model).then(function success(response) {\n            _currentUser = new User(response.data);\n            deferred.resolve(_currentUser);\n        }, function error(response) {\n            deferred.reject(response);\n        });\n        return deferred.promise;\n    };\n\n    Users.signInWithFacebook = function (auth) {\n        var deferred = $q.defer();\n        $http.post(APP.API + '/api/users/signinwithfacebook/', auth).then(function success(response) {\n            _currentUser = new User(response.data);\n            deferred.resolve(_currentUser);\n        }, function error(response) {\n            deferred.reject(response);\n        });\n        return deferred.promise;\n    };\n\n    Users.signout = function () {\n        var deferred = $q.defer();\n        $http.get(APP.API + '/api/users/signout/').then(function success(response) {\n            _currentUser = null;\n            deferred.resolve(response.data);\n        }, function error(response) {\n            deferred.reject(response);\n        });\n        return deferred.promise;\n    };\n\n    Users.detail = function (userRoute) {\n        var deferred = $q.defer();\n        $http.get(APP.API + '/api/users/route/' + userRoute).then(function success(response) {\n            deferred.resolve(new User(response.data));\n        }, function error(response) {\n            deferred.reject(response);\n        });\n        return deferred.promise;\n    };\n\n    return Users;\n}]);\n\napp.factory('Vector', function() {\n\tfunction Vector(x, y) {\n        this.x = x || 0;\n        this.y = y || 0;\n    }\n    Vector.make = function (a, b) {\n        return new Vector(b.x - a.x, b.y - a.y);\n    };\n    Vector.size = function (a) {\n        return Math.sqrt(a.x * a.x + a.y * a.y);\n    };\n    Vector.normalize = function (a) {\n        var l = Vector.size(a);\n        a.x /= l;\n        a.y /= l;\n        return a;\n    };\n    Vector.incidence = function (a, b) {\n        var angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\n        // if (angle < 0) angle += 2 * Math.PI;\n        // angle = Math.min(angle, (Math.PI * 2 - angle));\n        return angle;\n    };\n    Vector.distance = function (a, b) {\n        return Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\n    };\n    Vector.cross = function (a, b) {\n        return (a.x * b.y) - (a.y * b.x);\n    };\n    Vector.difference = function (a, b) {\n        return new Vector(b.x - a.x, b.y - a.y);\n    };\n    Vector.prototype = {\n        size: function () {\n            return Vector.size(this);\n        },\n        normalize: function () {\n            return Vector.normalize(this);\n        },\n        incidence: function (b) {\n            return Vector.incidence(this, b);\n        },\n        cross: function (b) {\n            return Vector.cross(this, b);\n        },\n        towards: function (b, friction) {\n            friction = friction || 0.125;\n            this.x += (b.x - this.x) * friction;\n            this.y += (b.y - this.y) * friction;\n            return this;\n        },\n        add: function (b) {\n            this.x += b.x;\n            this.y += b.y;\n            return this;\n        },\n        friction: function (b) {\n            this.x *= b;\n            this.y *= b;\n            return this;\n        },\n        copy: function (b) {\n            return new Vector(this.x, this.y);\n        },\n        toString: function () {\n            return '{' + this.x + ',' + this.y + '}';\n        },\n    };\n    return Vector;\n});\n\napp.factory('Utils', ['Vector', function (Vector) {\n    (function () {\n        var lastTime = 0;\n        var vendors = ['ms', 'moz', 'webkit', 'o'];\n        for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n            window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n            window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame']\n                                       || window[vendors[x] + 'CancelRequestAnimationFrame'];\n        }\n        if (!window.requestAnimationFrame) {\n            window.requestAnimationFrame = function (callback, element) {\n                var currTime = new Date().getTime();\n                var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n                var id = window.setTimeout(function () { callback(currTime + timeToCall); }, timeToCall);\n                lastTime = currTime + timeToCall;\n                return id;\n            };\n        }\n        if (!window.cancelAnimationFrame) {\n            window.cancelAnimationFrame = function (id) {\n                clearTimeout(id);\n            };\n        }\n    }());\n\n    var transformProperty = function detectTransformProperty() {\n        var transformProperty = 'transform',\n            safariPropertyHack = 'webkitTransform';\n\t\tvar div = document.createElement(\"DIV\");\n        if (typeof div.style[transformProperty] !== 'undefined') {\n            ['webkit', 'moz', 'o', 'ms'].every(function(prefix) {\n                var e = '-' + prefix + '-transform';\n                if (typeof div.style[e] !== 'undefined') {\n                    transformProperty = e;\n                    return false;\n                }\n                return true;\n            });\n        } else if (typeof div.style[safariPropertyHack] !== 'undefined') {\n            transformProperty = '-webkit-transform';\n        } else {\n            transformProperty = undefined;\n        }\n        return transformProperty;\n    } ();\n\n    var _isTouch;\n    function isTouch() {\n        if (!_isTouch) {\n            _isTouch = {\n                value: ('ontouchstart' in window || 'onmsgesturechange' in window)\n            }\n        }\n        // console.log(_isTouch);\n        return _isTouch.value;\n    }\n\n    function getTouch(e, previous) {\n        var t = new Vector();\n        if (e.type == 'touchstart' || e.type == 'touchmove' || e.type == 'touchend' || e.type == 'touchcancel') {\n            var touch = null;\n            var event = e.originalEvent ? e.originalEvent : e;\n            var touches = event.touches.length ? event.touches : event.changedTouches;\n            if (touches && touches.length) {\n                touch = touches[0];\n            }\n            if (touch) {\n                t.x = touch.pageX;\n                t.y = touch.pageY;\n            }\n        } else if (e.type == 'click' || e.type == 'mousedown' || e.type == 'mouseup' || e.type == 'mousemove' || e.type == 'mouseover' || e.type == 'mouseout' || e.type == 'mouseenter' || e.type == 'mouseleave') {\n            t.x = e.pageX;\n            t.y = e.pageY;\n        }\n        if (previous) {\n            t.s = Vector.difference(previous, t);\n        }\n        t.type = e.type;\n        return t;\n    }\n\n    function getRelativeTouch(element, point) {\n        var rect = element[0].getBoundingClientRect();\n        var e = new Vector(rect.left,  rect.top);\n        return Vector.difference(e, point);\n    }\n\n    function getClosest(el, selector) {\n        var matchesFn, parent;\n        ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function (fn) {\n            if (typeof document.body[fn] == 'function') {\n                matchesFn = fn;\n                return true;\n            }\n            return false;\n        });\n        while (el !== null) {\n            parent = el.parentElement;\n            if (parent !== null && parent[matchesFn](selector)) {\n                return parent;\n            }\n            el = parent;\n        }\n        return null;\n    }\n\n\n    var getNow = Date.now || function() {\n        return new Date().getTime();\n    };\n\n    function throttle(func, wait, options) {\n        // Returns a function, that, when invoked, will only be triggered at most once\n        // during a given window of time. Normally, the throttled function will run\n        // as much as it can, without ever going more than once per `wait` duration;\n        // but if you'd like to disable the execution on the leading edge, pass\n        // `{leading: false}`. To disable execution on the trailing edge, ditto.\n        var context, args, result;\n        var timeout = null;\n        var previous = 0;\n        if (!options) options = {};\n        var later = function () {\n            previous = options.leading === false ? 0 : getNow();\n            timeout = null;\n            result = func.apply(context, args);\n            if (!timeout) context = args = null;\n        };\n        return function () {\n            var now = getNow();\n            if (!previous && options.leading === false) previous = now;\n            var remaining = wait - (now - previous);\n            context = this;\n            args = arguments;\n            if (remaining <= 0 || remaining > wait) {\n                if (timeout) {\n                    clearTimeout(timeout);\n                    timeout = null;\n                }\n                previous = now;\n                result = func.apply(context, args);\n                if (!timeout) context = args = null;\n            } else if (!timeout && options.trailing !== false) {\n                timeout = setTimeout(later, remaining);\n            }\n            return result;\n        };\n    }\n\n    var Style = function() {\n        function Style() {\n            this.props = {\n                scale: 1,\n                hoverScale: 1,\n                currentScale: 1,\n            }\n        }\n        Style.prototype = {\n            set: function (element) {\n                var styles = [];\n                angular.forEach(this, function (value, key) {\n                    if (key !== 'props')\n                        styles.push(key + ':' + value);\n                });\n                element.style.cssText = styles.join(';') + ';';\n            },\n            transform: function (transform) {\n                this[Utils.transformProperty] = transform;\n            },\n            transformOrigin: function (x, y) {\n                this[Utils.transformProperty + '-origin-x'] = (Math.round(x * 1000) / 1000) + '%';\n                this[Utils.transformProperty + '-origin-y'] = (Math.round(y * 1000) / 1000) + '%';\n            },\n        };\n        return Style;\n    }();\n\n    function Utils() {\n    }\n\n\tUtils.transformProperty = transformProperty;\n    Utils.getTouch = getTouch;\n    Utils.getRelativeTouch = getRelativeTouch;\n    Utils.getClosest = getClosest;\n    Utils.throttle = throttle;\n    Utils.Style = Style;\n\n    return Utils;\n}]);\n\n/*global angular*/\n\napp.factory('WebWorker', ['$q', '$http', function ($q, $http) {\n    var isWebWorkerSupported = (typeof (Worker) !== \"undefined\");\n    if (!isWebWorkerSupported) {\n        window.Worker = function () {\n            function Worker(src) {\n                var self = this;\n                $http.get(src, { transformResponse: function (d, h) { return d } }).then(function success(response) {\n                    try {\n                        eval('self.o = function(){ function postMessage(e) { self.onmessage({data:e}); }\\n ' + response.data + ' };');\n                        self.object = new self.o();\n                        self.object.postMessage = function (e) {\n                            self.onmessage({data:e});\n                        }\n                    } catch(e) {\n                        console.log(\"Worker error \", e);\n                    }\n                }, function error(response) {\n                    console.log(\"Worker not found\");\n                });\n            }\n            Worker.prototype = {\n                onmessage: function (e) {\n                    console.log('Worker not implemented');\n                },\n                postMessage: function (e) {\n                    this.object.onmessage({ data: e });\n                }\n            }\n            return Worker;\n        } ();\n    }\n    function WebWorker(src) {\n        var self = this;\n        this.callbacks = {};\n        this.id = 0;\n        this.worker = new Worker(src);\n        this.worker.onmessage = function (e) {\n            self.onmessage(e);\n        };\n    }\n    WebWorker.prototype = {\n        parse: function (e) {\n            return JSON.parse(e.data);\n        },\n        stringify: function (data) {\n            return JSON.stringify(data);\n        },\n        onmessage: function (e) {\n            var data = this.parse(e);\n            var deferred = this.callbacks[data.id];\n            if (data.status !== -1) {\n                deferred.resolve(data);\n            } else {\n                deferred.reject(data);\n            }\n            delete this.callbacks[data.id];\n        },\n        post: function (data) {\n            var deferred = $q.defer();\n            data.id = this.id;\n            this.callbacks[this.id.toString()] = deferred;\n            this.id++;\n            this.worker.postMessage(this.stringify(data));\n            return deferred.promise;\n        },\n    };\n    WebWorker.isSupported = isWebWorkerSupported;\n    return WebWorker;\n}]);\n\napp.factory('$httpAsync', ['$q', '$http', function ($q, $http) {\n    var isWebWorkerSupported = (typeof (Worker) !== \"undefined\");\n    if (!isWebWorkerSupported) {\n        return $http;\n    }\n    var worker = new Worker('/js/workers/http.min.js');\n    var callbacks = {};\n    var id = 0;\n    var lowercase = function (string) { return isString(string) ? string.toLowerCase() : string; };\n    var trim = function (value) {\n        return isString(value) ? value.trim() : value;\n    };\n    function $httpAsync(options) {\n        var deferred = $q.defer();\n        var wrap = getDefaults(options);\n        wrap.id = id.toString();\n        console.log('wrap', wrap);\n        callbacks[wrap.id] = deferred;\n        id++;\n        worker.postMessage($httpAsync.stringify(wrap));\n        return deferred.promise;\n    }\n    $httpAsync.get = function (url, config) {\n        return $httpAsync(angular.extend({}, config || {}, {\n            method: 'GET',\n            url: url\n        }));\n    };\n    $httpAsync.delete = function (url, config) {\n        return $httpAsync(angular.extend({}, config || {}, {\n            method: 'DELETE',\n            url: url\n        }));\n    };\n    $httpAsync.head = function (url, config) {\n        return $httpAsync(angular.extend({}, config || {}, {\n            method: 'HEAD',\n            url: url\n        }));\n    };\n    $httpAsync.post = function (url, data, config) {\n        return $httpAsync(angular.extend({}, config || {}, {\n            method: 'POST',\n            data: data,\n            url: url\n        }));\n    };\n    $httpAsync.put = function (url, data, config) {\n        return $httpAsync(angular.extend({}, config || {}, {\n            method: 'PUT',\n            data: data,\n            url: url\n        }));\n    };\n    $httpAsync.patch = function (url, data, config) {\n        return $httpAsync(angular.extend({}, config || {}, {\n            method: 'PATCH',\n            data: data,\n            url: url\n        }));\n    };\n    $httpAsync.parse = function (e) {\n        return JSON.parse(e.data);\n    };\n    $httpAsync.stringify = function (data) {\n        return JSON.stringify(data);\n    };\n    $httpAsync.isSupported = isWebWorkerSupported;\n    worker.onmessage = function (e) {\n        var wrap = $httpAsync.parse(e);\n        console.log('onmessage', wrap);\n        var deferred = callbacks[wrap.id];\n        var status = wrap.status >= -1 ? wrap.status : 0;\n        var getter = headersGetter(wrap.response.headers);\n        (isSuccess(status) ? deferred.resolve : deferred.reject)({\n            data: wrap.response.data, // !!!! JSON.parse(wrap.response.data),\n            headers: getter,\n            status: wrap.response.status,\n            statusText: wrap.response.statusText,\n            config: wrap.config,\n        });\n        delete callbacks[wrap.id];\n    }\n    return $httpAsync;\n    function isSuccess(status) {\n        return 200 <= status && status < 300;\n    }\n    function createMap() {\n        return Object.create(null);\n    }\n    function isString(value) { return typeof value === 'string'; }\n    function parseHeaders(headers) {\n        var parsed = createMap(), i;\n        function fillInParsed(key, val) {\n            if (key) {\n                parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n            }\n        }\n        if (isString(headers)) {\n            var a = headers.split('\\n');\n            for (var j = 0; j < a.length; j++) {\n                var line = a[j];\n                i = line.indexOf(':');\n                fillInParsed(lowercase(trim(line.substr(0, i))), trim(line.substr(i + 1)));\n            }\n        } else if (isObject(headers)) {\n            for (var p in headers) {\n                fillInParsed(lowercase(p), trim(headers[p]));\n            }\n        }\n        return parsed;\n    }\n    function headersGetter(headers) {\n        var headersObj;\n        return function (name) {\n            if (!headersObj) headersObj = parseHeaders(headers);\n            if (name) {\n                var value = headersObj[lowercase(name)];\n                if (value === void 0) {\n                    value = null;\n                }\n                return value;\n            }\n            return headersObj;\n        };\n    }\n    function getDefaults(options) {\n        var defaults = {\n            method: 'GET',\n            withCredentials: false,\n            responseType: 'json',\n            headers: {},\n            config: {}\n        }\n        defaults.withCredentials = $http.defaults.withCredentials;\n        angular.extend(defaults.headers, $http.defaults.headers.common);\n        var method = (options.method || defaults.method).toLowerCase();\n        if ($http.defaults.headers[method]) {\n            angular.extend(defaults.headers, $http.defaults.headers[method]);\n        }\n        console.log('defaults', $http.defaults);\n        // defaults = angular.extend(defaults, $http.defaults);\n        /*\n    method{string}:                     HTTP method (e.g. 'GET', 'POST', etc)\n    url:{string}:                       Absolute or relative URL of the resource that is being requested.\n    params:{Object.<string|Object>}:    Map of strings or objects which will be serialized with the paramSerializer and appended as GET parameters.\n\n    data:{string|Object}:               Data to be sent as the request message data.\n    headers:{Object}:                   Map of strings or functions which return strings representing HTTP headers to send to the server. If the return value of a function is null, the header will not be sent. Functions accept a config object as an argument.\n\n    xsrfHeaderName:{string}:            Name of HTTP header to populate with the XSRF token.\n    xsrfCookieName:{string}:            Name of cookie containing the XSRF token.\n    transformRequest:{function(data, headersGetter)|Array.<function(data, headersGetter)>}:         transform function or an array of such functions. The transform function takes the http request body and headers and returns its transformed (typically serialized) version. See Overriding the Default Transformations\n\n    transformResponse:{function(data, headersGetter, status)|Array.<function(data, headersGetter, status)>}:    transform function or an array of such functions. The transform function takes the http response body, headers and status and returns its transformed (typically deserialized) version. See Overriding the Default TransformationjqLiks\n\n    paramSerializer:{string|function(Object<string,string>):string}:        A function used to prepare the string representation of request parameters (specified as an object). If specified as string, it is interpreted as function registered with the $injector, which means you can create your own serializer by registering it as a service. The default serializer is the $httpParamSerializer; alternatively, you can use the $httpParamSerializerJQLike\n\n    cache:{boolean|Cache}:              If true, a default $http cache will be used to cache the GET request, otherwise if a cache instance built with $cacheFactory, this cache will be used for caching.\n\n    timeout:{number|Promise}:           timeout in milliseconds, or promise that should abort the request when resolved.\n    withCredentials:{boolean}:          whether to set the withCredentials flag on the XHR object. See requests with credentials for more information.\n\n    responseType:{string}:              see XMLHttpRequest.responseType.\n        */\n        options ? options = angular.extend(defaults, options) : defaults;\n        return options;\n    }\n}]);\n"],"sourceRoot":"/source/"}